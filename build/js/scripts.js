"use strict";function shareing(t,a,e,o){function n(){l=location.href,i=$(o).find(".modal-book__text").attr("src")}var l="",r="title",i="",c="";$(o).on("click",t,function(t){t.preventDefault(),n(this);var a="https://vkontakte.ru/share.php?url="+l+"&title="+r+"&description="+c+"&image="+i;window.open(a,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(o).on("click",a,function(t){t.preventDefault(),n(this,a);var e="http://twitter.com/share?text="+r+"&url=http://"+l+"&counturl="+l;window.open(e,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(o).on("click",e,function(t){t.preventDefault(),n(this,e);var a="http://instagram.com/share?text="+r+"&url=http://"+l+"&counturl="+l;window.open(a,"Поделиться","toolbar=0,status=0,width=626,height=436")})}$(document).ready(function(){function t(){h?($(".lds-ripple").fadeIn(500),$(".modal-preview").fadeOut(250)):($(".lds-ripple").fadeOut(250),$(".modal-preview").fadeIn(500))}function a(t){var a="";t.map(function(t){var e=t.pageCount,o=t.linePerPageCount;a+="\n    <div data-id=".concat(t.id,' data-pageCount="').concat(e,'" data-linesCount="').concat(o,'" class="slide-item">\n      <h1>').concat(t.name,"</h1>\n      <h2>").concat(t.author,"</h2>\n      <span>").concat(t.yearPublishing,'</span>\n      <img src="').concat(t.img,'" alt="">\n    </div>\n    ')}),$(".modal-slider").html(a)}function e(){for(var t=Number($(".slick-active").attr("data-pageCount")),a=Number($(".slick-active").attr("data-linesCount")),e="",o="",n=1;t+1>n;n++)e+='<div class="modal-bar__item">'.concat(n,"</div>");for(var l=1;a+1>l;l++)o+='<div class="modal-bar__item">'.concat(l,"</div>");$(u).eq(0).html(e),$(u).eq(1).html(o),Number($(m).eq(0).html())>t&&$(m).eq(0).html(t),Number($(m).eq(1).html()>a)&&$(m).eq(1).html(a)}function o(o){h=!0,t(),$(".button-play").on("click",function(){h===!0&&$.ajax({url:o,type:"GET",success:function(o){h=!1,t(),o.length>0&&""!=o&&(a(o),f=o,$(".modal-slider").slick({infinite:!0,slidesToShow:1,slidesToScroll:1,prevArrow:$(".slider-arrow__left"),nextArrow:$(".slider-arrow__right")}),e())}})})}function n(){$(p).on("click",function(){$(v).fadeIn(300),$(".modal-preview").css("display","none")&&h===!1&&$(".modal-preview").fadeIn(500)}),$(b).on("click",function(){$(v).fadeOut(300),$(".modal-book").hide(),$(".modal-preview").fadeIn(500)})}function l(){$(document).mouseup(function(t){_.is(t.target)||0!==_.has(t.target).length||($(v).fadeOut(300),$(".modal-book").hide())})}function r(){function t(t){$(".modal-bar__select").removeClass("select-active");var a=30*$(".modal-bar__select").eq(t).children().length;$(".modal-bar__select").eq(t).css(a>=210?{"max-height":"210px","overflow-y":"auto"}:{overflow:"visible",height:"".concat(a,"px")}),$(".modal-bar__select").eq(t).addClass("select-active")}$(g).on("click",function(){t($(this).siblings($(".modal-bar__select")).hasClass("select-page")?0:1)})}function i(){$(document).mouseup(function(t){$(".modal-bar__select").is(t.target)||0!==$(".modal-bar__select").has(t.target).length||($(".modal-bar__select").css({"max-height":"0",overflow:"hidden"}),$(".modal-bar__select").removeClass("select-active"))})}function c(){$(".modal-bar__select").on("click",".modal-bar__item",function(){var t=$(this).text();$(this).closest($(".modal-bar__select")).hasClass("select-page")?$(".modal-bar__current").eq(0).html(t):$(".modal-bar__current").eq(1).html(t),$(this).closest(".modal-bar__select").css({"max-height":"0",overflow:"hidden"}),$(".modal-bar__select").removeClass("select-active")})}function s(t){var a=$(".slick-current").attr("data-id"),e=Number($(m).eq(0).html()),o=Number($(m).eq(1).html()),n="";if(t){var l=f[Math.floor(Math.random()*f.length)];a=l.id,e=Math.floor(Math.random()*l.pageCount+1),o=Math.floor(Math.random()*l.linePerPageCount+1),n="http://moya-kniga.ru/ajax/game.php?id=".concat(a,"&pageNumber=").concat(e,"&linePerPageNumber=").concat(o)}else n="http://moya-kniga.ru/ajax/game.php?id=".concat(a,"&pageNumber=").concat(e,"&linePerPageNumber=").concat(o);$(".modal-book").fadeIn(500),d(n)}function d(t){var a=$(".modal-book__text");$(a).attr("src",t)}var m=$(".modal-bar__current"),u=$(".modal-bar__select"),h=!1,f=[];$(".modal-slider").on("afterChange",function(){return e()}),o("https://cors-anywhere.herokuapp.com/moya-kniga.ru/ajax/game.php");var p=$(".button-play"),v=$(".modal-bg"),_=$(".modal-content"),b=$(".modal-close");n(),l();var g=$(".modal-bar__current");r(),i(),c();var k=$(".modal-button");$(k).on("click",function(){$(".modal-preview").hide(),s()});var w=$(".modal-button__random");$(w).on("click",function(){$(".modal-preview").hide(),s(!0)});var x=$(".modal-button__newrandom");$(x).on("click",function(){s(!0)});var C=$(".modal-again");$(C).on("click",function(){$(".modal-preview").fadeIn(500),$(".modal-book").hide()})}),shareing(".social-vk-share",".social-twitter-share",".social-instagram-share",".modal-book");