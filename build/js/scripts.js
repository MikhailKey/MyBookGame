"use strict";$(document).ready(function(){function t(){h?$(".lds-ripple").fadeIn(500):$(".lds-ripple").fadeOut(250)}function a(t){var a="";t.map(function(t){var e=t.pageCount,o=t.linePerPageCount;a+="\n      <div data-id=".concat(t.id,' data-pageCount="').concat(e,'" data-linesCount="').concat(o,'" class="slide-item">\n        <h1>').concat(t.name,"</h1>\n        <h2>").concat(t.author,"</h2>\n        <span>").concat(t.yearPublishing,'</span>\n        <img src="').concat(t.img,'" alt="">\n      </div>\n      ')}),$(".modal-slider").html(a)}function e(){for(var t=Number($(".slick-active").attr("data-pageCount")),a=Number($(".slick-active").attr("data-linesCount")),e="",o="",n=1;t+1>n;n++)e+='<div class="modal-bar__item">'.concat(n,"</div>");for(var r=1;a+1>r;r++)o+='<div class="modal-bar__item">'.concat(r,"</div>");$(m).eq(0).html(e),$(m).eq(1).html(o),Number($(d).eq(0).html())>t&&$(d).eq(0).html(t),Number($(d).eq(1).html()>a)&&$(d).eq(1).html(a)}function o(o){var n=$(".button-play");$(n).on("click",function(){$(u).css("display","none")&&h===!1&&(h=!0,t(),$(".modal-start").fadeOut(250)),h===!0&&$.ajax({url:o,type:"GET",success:function(o){h=!1,t(),$(u).fadeIn(500),o.length>0&&""!=o&&(a(o),p=o,$(".modal-slider").slick({infinite:!0,slidesToShow:1,slidesToScroll:1,prevArrow:$(".slider-arrow__left"),nextArrow:$(".slider-arrow__right")}),e())}})})}function n(){function t(t){$(".modal-bar__select").removeClass("select-active");var a=30*$(".modal-bar__select").eq(t).children().length;$(".modal-bar__select").eq(t).css(a>=210?{"max-height":"210px","overflow-y":"auto"}:{overflow:"visible",height:"".concat(a,"px")}),$(".modal-bar__select").eq(t).addClass("select-active")}$(_).on("click",function(){t($(this).siblings($(".modal-bar__select")).hasClass("select-page")?0:1)})}function r(){$(document).mouseup(function(t){$(".modal-bar__select").is(t.target)||0!==$(".modal-bar__select").has(t.target).length||($(".modal-bar__select").css({"max-height":"0",overflow:"hidden"}),$(".modal-bar__select").removeClass("select-active"))})}function c(){$(".modal-bar__select").on("click",".modal-bar__item",function(){var t=$(this).text();$(this).closest($(".modal-bar__select")).hasClass("select-page")?$(".modal-bar__current").eq(0).html(t):$(".modal-bar__current").eq(1).html(t),$(this).closest(".modal-bar__select").css({"max-height":"0",overflow:"hidden"}),$(".modal-bar__select").removeClass("select-active")})}function l(t){var a=$(".slick-current").attr("data-id"),e=Number($(d).eq(0).html()),o=Number($(d).eq(1).html()),n="";if(t){var r=p[Math.floor(Math.random()*p.length)];a=r.id,e=Math.floor(Math.random()*r.pageCount+1),o=Math.floor(Math.random()*r.linePerPageCount+1),n="http://moya-kniga.ru/ajax/game.php?id=".concat(a,"&pageNumber=").concat(e,"&linePerPageNumber=").concat(o)}else n="http://moya-kniga.ru/ajax/game.php?id=".concat(a,"&pageNumber=").concat(e,"&linePerPageNumber=").concat(o);$(f).fadeIn(500),i(n)}function i(t){var a=$(".modal-book__text");$(a).attr("src",t)}function s(t,a,e,o,n){function r(){c=encodeURIComponent("http://moya-kniga.ru/#game"),i=encodeURIComponent($(n).find(".modal-book__text").attr("src"))}var c="",l="game",i="",s="";$(n).on("click",t,function(t){t.preventDefault(),r(this);var a="https://vkontakte.ru/share.php?url="+c+"&title="+l+"&description="+s+"&image="+i;window.open(a,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(n).on("click",a,function(t){t.preventDefault(),r(this);var a="https://twitter.com/share?url="+i+"&text="+l;window.open(a,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(n).on("click",e,function(t){t.preventDefault(),r(this);var a="https://www.facebook.com/sharer/sharer.php?u="+i;window.open(a,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(n).on("click",o,function(t){t.preventDefault(),r(this);var a="https://connect.ok.ru/offer?url="+i;window.open(a,"Поделиться","toolbar=0,status=0,width=626,height=436")})}var d=$(".modal-bar__current"),m=$(".modal-bar__select"),h=!1,u=$(".modal-preview"),f=$(".modal-book"),p=[];$(".modal-slider").on("afterChange",function(){return e()}),o("https://cors-anywhere.herokuapp.com/moya-kniga.ru/ajax/game.php");var _=$(".modal-bar__current");n(),r(),c();var v=$(".modal-button");$(v).on("click",function(){$(u).hide(),l()});var b=$(".modal-button__random");$(b).on("click",function(){$(u).hide(),l(!0)});var g=$(".modal-button__newrandom");$(g).on("click",function(){l(!0)});var k=$(".modal-again");$(k).on("click",function(){$(u).fadeIn(500),$(f).hide()}),s(".social-vk-share",".social-twitter-share",".social-facebook-share",".social-odnoklassniki-share",".modal-book")});