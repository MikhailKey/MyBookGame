"use strict";$(document).ready(function(){function a(){m?$(".lds-ripple").fadeIn(500):$(".lds-ripple").fadeOut(250)}function t(a){var t="";a.map(function(a){var e=a.pageCount,o=a.linePerPageCount;t+="\n      <div data-id=".concat(a.id,' data-pageCount="').concat(e,'" data-linesCount="').concat(o,'" class="slide-item">\n        <h1>').concat(a.name,"</h1>\n        <h2>").concat(a.author,"</h2>\n        <span>").concat(a.yearPublishing,'</span>\n        <img src="').concat(a.img,'" alt="">\n      </div>\n      ')}),$(".modal-slider").html(t)}function e(){for(var a=Number($(".slick-active").attr("data-pageCount")),t=Number($(".slick-active").attr("data-linesCount")),e="",o="",n=1;a+1>n;n++)e+='<div class="modal-bar__item">'.concat(n,"</div>");for(var r=1;t+1>r;r++)o+='<div class="modal-bar__item">'.concat(r,"</div>");$(d).eq(0).html(e),$(d).eq(1).html(o),Number($(u).eq(0).attr("value"))>a&&$(u).eq(0).attr("value",a),Number($(u).eq(1).attr("value")>t)&&$(u).eq(1).attr("value",t)}function o(o){var n=$(".button-play");$(n).on("click",function(){$(h).css("display","none")&&m===!1&&(m=!0,a(),$(".modal-start").fadeOut(250)),m===!0&&$.ajax({url:o,type:"GET",success:function(o){m=!1,a(),$(h).fadeIn(500),o.length>0&&""!=o&&(t(o),_=o,$(".modal-slider").slick({infinite:!0,slidesToShow:1,slidesToScroll:1,prevArrow:$(".slider-arrow__left"),nextArrow:$(".slider-arrow__right")}),e())}})})}function n(){function a(a){$(".modal-bar__select").removeClass("select-active");var t=30*$(".modal-bar__select").eq(a).children().length;$(".modal-bar__select").eq(a).css(t>=210?{"max-height":"210px","overflow-y":"auto"}:{overflow:"visible",height:"".concat(t,"px")}),$(".modal-bar__select").eq(a).addClass("select-active")}$(b).on("click",function(){a($(this).siblings($(".modal-bar__select")).hasClass("select-page")?0:1)})}function r(){$(document).mouseup(function(a){$(".modal-bar__select").is(a.target)||0!==$(".modal-bar__select").has(a.target).length||($(".modal-bar__select").css({"max-height":"0",overflow:"hidden"}),$(".modal-bar__select").removeClass("select-active"))})}function l(){$(".modal-bar__select").on("click",".modal-bar__item",function(){var a=$(this).text();$(this).closest($(".modal-bar__select")).hasClass("select-page")?($(".modal-bar__current").eq(0).val(""),$(".modal-bar__current").eq(0).val(a),$(".modal-bar__current").eq(0).attr("value",a)):($(".modal-bar__current").eq(1).val(""),$(".modal-bar__current").eq(1).val(a),$(".modal-bar__current").eq(1).attr("value",a)),$(this).closest(".modal-bar__select").css({"max-height":"0",overflow:"hidden"}),$(".modal-bar__select").removeClass("select-active")})}function c(a){var t=$(".slick-current").attr("data-id"),e=Number($(u).eq(0).attr("value")),o=Number($(u).eq(1).attr("value")),n="";if(a){var r=_[Math.floor(Math.random()*_.length)];t=r.id,e=Math.floor(Math.random()*r.pageCount+1),o=Math.floor(Math.random()*r.linePerPageCount+1),n="http://moya-kniga.ru/ajax/game.php?id=".concat(t,"&pageNumber=").concat(e,"&linePerPageNumber=").concat(o)}else n="http://moya-kniga.ru/ajax/game.php?id=".concat(t,"&pageNumber=").concat(e,"&linePerPageNumber=").concat(o);$(v).fadeIn(500),i(n)}function i(a){var t=$(".modal-book__text");$(t).attr("src",a)}function s(a,t,e,o,n){function r(){l=encodeURIComponent("http://moya-kniga.ru/#game"),i=encodeURIComponent($(n).find(".modal-book__text").attr("src"))}var l="",c="game",i="",s="";$(n).on("click",a,function(a){a.preventDefault(),r(this);var t="https://vkontakte.ru/share.php?url="+l+"&title="+c+"&description="+s+"&image="+i;window.open(t,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(n).on("click",t,function(a){a.preventDefault(),r(this);var t="https://twitter.com/share?url="+i+"&text="+c;window.open(t,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(n).on("click",e,function(a){a.preventDefault(),r(this);var t="https://www.facebook.com/sharer/sharer.php?u="+i;window.open(t,"Поделиться","toolbar=0,status=0,width=626,height=436")}),$(n).on("click",o,function(a){a.preventDefault(),r(this);var t="https://connect.ok.ru/offer?url="+i;window.open(t,"Поделиться","toolbar=0,status=0,width=626,height=436")})}var u=$(".modal-bar__current"),d=$(".modal-bar__select"),m=!1,h=$(".modal-preview"),v=$(".modal-book"),_=[];$(".modal-slider").on("afterChange",function(){return e()}),o("https://cors-anywhere.herokuapp.com/moya-kniga.ru/ajax/game.php");var b=$(".modal-bar__current");n(),r(),l();var f=$(".modal-button");$(f).on("click",function(){$(h).hide(),c()});var p=$(".modal-button__random");$(p).on("click",function(){$(h).hide(),c(!0)});var g=$(".modal-button__newrandom");$(g).on("click",function(){c(!0)});var k=$(".modal-bar__current");$(k).each(function(a,t){$(t).on("input",function(a){$(this).siblings($(".modal-bar__select")).hasClass("select-page")?$(this).val()>Number($(".slick-active").attr("data-pagecount"))&&$(this).val(Number($(".slick-active").attr("data-pagecount"))):$(this).val()>Number($(".slick-active").attr("data-linescount"))&&$(this).val(Number($(".slick-active").attr("data-linescount"))),$(this).attr("value",a.target.value),$(this).html(a.target.value)})});var w=$(".modal-again");$(w).on("click",function(){$(h).fadeIn(500),$(v).hide()}),s(".social-vk-share",".social-twitter-share",".social-facebook-share",".social-odnoklassniki-share",".modal-book")});